<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <h1>Send Message to server</h1>
    <input id="new-message" type="text" placeholder="Insirir mensagem">
    <button name = "button" onclick="sendMessage()" >
        Enviar
    </button>

    <p id="messages"></p>

    <script>
        const mySocket = new WebSocket("ws://34.70.172.41:3333/");

        function sendMessage(){
            var msg = {
                type : "message",
                text: document.getElementById("new-message").value,
                date: Date.now
            };
            

            mySocket.onopen = function(envent){
                mySocket.send(JSON.stringify(msg)).then(console.log("message sent"));
                document.getElementById("new-message").value = "";
                
            }


        }

        mySocket.onmessage = function(event){
            console.log(event.data);
           /* var f = document.getElementById("messages").contentDocument;
            var text = "";
            var msg = JSON.parse(event.data);
            var time = msg.time;
            var timeStr =time +"";

            switch(msg.type){
                case "messages":
                    text = "<b>" + timeStr + " - " +  msg.text + "</b><b>";
                    break;
                case "status": 
                    text = "<b>" + timeStr + " - " + msg.status + "</b><b>";
            }

            if(text.length){
                f.write(text);
                document.getElementById("messages").contentWindow.scrollByPages(1);
            }*/
        }

    
    </script>
</body>
</html>